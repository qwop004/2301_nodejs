<!-- views/subscribers.ejs -->

<main class="">
  <div class="container col-xl-10 col-xxl-8 px-4 py-5">
    <div class="pt-5 pb-5">
      <h1>Clubs</h1>

      <table class="table table-striped table-hover pb-5">
        <!-- <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">이미지</th>
            <th scope="col">이름</th>
            <th scope="col">이메일</th>
            <th scope="col">전화번호</th>
            <th scope="col">뉴스레터 구독자</th>
          </tr>
        </thead> -->
        <tbody>
          <% subscribers.forEach((s, i) => { %>
            <td>
              <figure class="clubs-img">
                <img src="<%= s.clubImage %>" />
              </figure><br>
              <li><%= s.clubName %></li><br>
              <li><a href="<%= s.clubSite %>">Club Site</a></li><br>
              <!-- <li><%= s.phoneNumber %></li><br> -->
              <% if (s.newsletter) { %>
                <li><span class="fas fa-check">✅</span></li><br>
                <% } else { %>
                  <li><span class="fas fa-times">❌</span></li><br>
                <% } %>
            </td>
            <% if ((i+1) % 4 == 0) { %>
              </tr><% } %>
          <% }); %>
        </tbody>
      </table>

      <div class="mt-5 mb-5 text-center">
        <a href="/subscribers/new" class="btn btn-primary">Add New Subscriber</a>
        <a
          href="/"
          class="btn ut-red disabled"
          role="button"
          aria-disabled="true"
          >Delete All Subscribers</a
        >
        <button id="restore-db" class="btn btn-secondary" onclick="runNodeFunction()">Restore DB</button>
        <script>
          function runNodeFunction() {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "C:/Users/ADMIN/Desktop/UT/Classes/2023.1-UT-NodeJS/final-project/final-project-sample/knut/data/seedSubscribers.js", true);
            xhr.onreadystatechange = function() {

              if (this.readyState === 4 && this.status === 200) {

                var response = this.responseText;
                eval(response); // Execute the response as JavaScript code
                here(); // Call the Node.js function

              }

            };

            xhr.send();

          }

        </script>
      </div>
    </div>
  </div>
</main>
